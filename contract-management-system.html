<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        /* é…ç½®å¸¸é‡ */
        :root {
            --primary-color: #1e40af;
            --primary-hover: #1d4ed8;
            --secondary-color: #3b82f6;
            --accent-color: #6366f1;
            --success-color: #059669;
            --warning-color: #d97706;
            --danger-color: #dc2626;
            --info-color: #0ea5e9;
            --light-blue: #f0f9ff;
            --sidebar-width: 280px;
            --header-height: 50px;
            --page-header-height: 60px;
            --toolbar-height: 48px;
            --status-bar-height: 36px;
            --border-radius: 8px;
            --box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --box-shadow-hover: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --transition: all 0.2s ease-in-out;
            --text-primary: #111827;
            --text-secondary: #374151;
            --text-muted: #6b7280;
            --bg-primary: #ffffff;
            --bg-secondary: #f9fafb;
            --bg-tertiary: #f3f4f6;
            --border-color: #e5e7eb;
            --border-light: #f3f4f6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', 'PingFang SC', 'Hiragino Sans GB', sans-serif;
            background: #f8fafc;
            min-height: 100vh;
            overflow: hidden;
            font-weight: 400;
            letter-spacing: -0.01em;
            color: var(--text-primary);
        }

        .app-container {
            display: flex;
            height: 100vh;
            width: 100vw;
            background: #f8fafc;
            position: relative;
        }

        /* å·¦ä¾§å¯¼èˆªæ æ ·å¼ */
        .sidebar {
            width: var(--sidebar-width);
            background: #ffffff;
            box-shadow: var(--box-shadow);
            position: relative;
            overflow-y: auto;
            border-right: 1px solid var(--border-color);
            z-index: 10;
        }

        /* å·¦ä¾§å¯¼èˆªæ æ»šåŠ¨æ¡æ ·å¼ */
        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: #f3f4f6;
            border-radius: 3px;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 3px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }

        .logo-section {
            padding: 20px 24px;
            text-align: center;
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-secondary);
        }

        .logo-title {
            color: var(--primary-color);
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .logo-subtitle {
            color: #8b9dc3;
            font-size: 12px;
            font-weight: 400;
        }

        .nav-menu {
            padding: 16px 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            margin: 2px 12px;
            border-radius: var(--border-radius);
            font-weight: 500;
        }

        .nav-item:hover {
            background: var(--bg-tertiary);
            color: var(--primary-color);
        }

        .nav-item.active {
            background: var(--primary-color);
            color: #ffffff;
            box-shadow: var(--box-shadow);
        }

        .nav-icon {
            font-size: 16px;
            margin-right: 8px;
            width: 20px;
            text-align: center;
        }

        .nav-text {
            font-size: 14px;
            flex: 1;
        }

        .nav-badge {
            background: var(--bg-tertiary);
            color: var(--text-muted);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .nav-item.active .nav-badge {
            background: rgba(255, 255, 255, 0.2);
            color: #ffffff;
        }

        /* å³ä¾§å†…å®¹åŒºåŸŸæ ·å¼ */
        .main-content {
            flex: 1;
            background: #ffffff;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            margin: 0;
            border-radius: 0;
            box-shadow: none;
            min-height: 0; /* é‡è¦ï¼šç¡®ä¿flexå­å…ƒç´ å¯ä»¥æ”¶ç¼© */
        }

        /* æ¨¡å—å†…å®¹å®¹å™¨ */
        .module-content {
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
        }

        /* é¡¶éƒ¨æ ‡é¢˜æ  */
        .top-header {
            height: var(--header-height);
            background: #ffffff;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            padding: 0 24px;
            flex-shrink: 0; /* é˜²æ­¢æ”¶ç¼© */
        }

        .system-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* é¡µé¢æ ‡é¢˜åŒº */
        .page-header {
            height: var(--page-header-height);
            padding: 12px 24px;
            border-bottom: 1px solid var(--border-color);
            background: #ffffff;
            flex-shrink: 0; /* é˜²æ­¢æ”¶ç¼© */
        }

        .page-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
            display: flex;
            align-items: center;
        }

        .page-icon {
            margin-right: 8px;
            font-size: 20px;
        }

        .page-description {
            color: var(--text-muted);
            font-size: 13px;
            margin-bottom: 0;
        }

        .page-stats {
            color: var(--primary-color);
            font-size: 13px;
            font-weight: 500;
        }

        /* æ“ä½œå·¥å…·æ  */
        .action-toolbar {
            height: var(--toolbar-height);
            padding: 8px 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-secondary);
            flex-shrink: 0; /* é˜²æ­¢æ”¶ç¼© */
        }

        .toolbar-left {
            display: flex;
            gap: 8px;
        }

        .toolbar-right {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .btn {
            padding: 6px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            background: #ffffff;
            color: #374151;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .btn-primary:hover {
            background: #5a67d8;
            border-color: #5a67d8;
        }

        .btn-secondary:hover {
            background: #f1f5f9;
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .search-group {
            display: flex;
            align-items: center;
            background: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 4px 8px;
            min-width: 200px;
        }

        .search-icon {
            color: #9ca3af;
            margin-right: 4px;
        }

        .search-input {
            border: none;
            outline: none;
            flex: 1;
            font-size: 13px;
            padding: 2px;
        }

        .filter-select {
            padding: 6px 8px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 13px;
            background: #ffffff;
            cursor: pointer;
        }

        /* æ•°æ®è¡¨æ ¼åŒº */
        .table-section {
            flex: 1;
            overflow: auto;
            padding: 0;
            min-height: 0; /* é‡è¦ï¼šç¡®ä¿å¯ä»¥æ”¶ç¼© */
        }

        /* ç¡®ä¿è¡¨æ ¼å®¹å™¨æœ‰æ»šåŠ¨æ¡ */
        .table-section::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .table-section::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        .table-section::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        .table-section::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* è¡¨æ ¼åŒ…è£…å™¨æ ·å¼ */
        .table-wrapper {
            flex: 1;
            overflow: auto;
            min-height: 0;
        }

        .table-wrapper::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .table-wrapper::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        .table-wrapper::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        .table-wrapper::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: #ffffff;
        }

        .data-table th {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e2e8f0;
            font-size: 13px;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .data-table td {
            padding: 12px 16px;
            border-bottom: 1px solid #f1f5f9;
            color: #4b5563;
            font-size: 13px;
        }

        .data-table tr:hover {
            background: #f8fafc;
        }

        .btn-action {
            padding: 4px 8px;
            margin-right: 4px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            background: #ffffff;
            color: #374151;
            transition: var(--transition);
        }

        .btn-action:hover {
            background: #f1f5f9;
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        /* çŠ¶æ€æ åŒºåŸŸ */
        .status-bar {
            height: var(--status-bar-height);
            padding: 8px 24px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-secondary);
            font-size: 13px;
            color: var(--text-muted);
            flex-shrink: 0; /* é˜²æ­¢æ”¶ç¼© */
        }

        .pagination-controls {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .page-btn {
            padding: 4px 8px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            background: #ffffff;
            color: #374151;
        }

        .page-btn:hover:not(:disabled) {
            background: #f1f5f9;
            border-color: var(--primary-color);
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .page-info {
            font-size: 12px;
            color: #64748b;
        }

        .page-size-select {
            padding: 4px 6px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 12px;
            background: #ffffff;
        }

        /* æœç´¢ç­›é€‰åŒºåŸŸæ ·å¼ */
        .search-filter-section {
            padding: 16px 24px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            flex-shrink: 0;
        }

        .filter-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .filter-row:last-child {
            margin-bottom: 0;
        }

        .date-input {
            padding: 4px 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 13px;
            background: #ffffff;
        }

        .filter-hint {
            color: var(--text-muted);
            font-size: 12px;
            margin-left: auto;
        }

        /* é¡¹ç›®é“¾æ¥å’Œæœªå…³è”æ–‡æœ¬æ ·å¼ */
        .project-link {
            color: var(--primary-color);
            font-weight: 500;
        }

        .unlinked-text {
            color: var(--text-muted);
            font-style: italic;
        }

        /* é€‰æ‹©ä¿¡æ¯æ ·å¼ */
        .selection-info {
            color: var(--text-muted);
            font-size: 13px;
        }

        /* ä¸Šä¼ åŒºåŸŸæ ·å¼ */
        .upload-section-compact {
            padding: 16px 24px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            flex-shrink: 0;
        }

        .upload-area-compact {
            border: 2px dashed var(--border-color);
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            background: #ffffff;
            transition: var(--transition);
        }

        .upload-area-compact:hover {
            border-color: var(--primary-color);
            background: var(--light-blue);
        }

        .upload-content-compact {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .upload-icon {
            font-size: 24px;
            color: var(--text-muted);
        }

        .upload-text {
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* å¯¼å…¥è¡¨æ ¼åŒºåŸŸæ ·å¼ */
        .import-table-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-height: 0;
        }

        .import-note {
            padding: 12px 24px;
            background: var(--light-blue);
            color: var(--text-secondary);
            font-size: 13px;
            border-top: 1px solid var(--border-color);
        }

        /* æ ‡ç­¾é¡µæ ·å¼ */
        .tab-section {
            height: 40px;
            padding: 0 24px;
            border-bottom: 1px solid #e2e8f0;
            background: #ffffff;
            flex-shrink: 0; /* é˜²æ­¢æ”¶ç¼© */
        }

        .tab-buttons {
            display: flex;
            gap: 0;
        }

        .tab-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            color: #64748b;
            font-size: 13px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: var(--transition);
        }

        .tab-btn.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            background: rgba(102, 126, 234, 0.05);
        }

        .tab-btn:hover {
            color: var(--primary-color);
            background: rgba(102, 126, 234, 0.05);
        }

        /* ä¸Šä¼ åŒºåŸŸæ ·å¼ */
        .upload-section {
            padding: 24px;
            border-bottom: 1px solid #e2e8f0;
            flex-shrink: 0; /* é˜²æ­¢æ”¶ç¼© */
        }

        .upload-section-compact {
            padding: 16px 24px;
            border-bottom: 1px solid #e2e8f0;
            flex-shrink: 0; /* é˜²æ­¢æ”¶ç¼© */
        }

        .upload-area {
            border: 2px dashed #e2e8f0;
            border-radius: var(--border-radius);
            padding: 32px;
            text-align: center;
            background: #f8fafc;
            cursor: pointer;
            transition: var(--transition);
        }

        .upload-area-compact {
            border: 2px dashed #e2e8f0;
            border-radius: var(--border-radius);
            padding: 16px;
            text-align: center;
            background: #f8fafc;
            cursor: pointer;
            transition: var(--transition);
        }

        .upload-area:hover,
        .upload-area-compact:hover {
            border-color: var(--primary-color);
            background: var(--light-blue);
        }

        .upload-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
        }

        .upload-content-compact {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            justify-content: center;
        }

        .upload-icon {
            font-size: 48px;
            color: var(--primary-color);
        }

        .upload-text {
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
        }

        .upload-hint {
            color: #64748b;
            font-size: 13px;
        }

        .upload-actions {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }

        /* æœç´¢ç­›é€‰åŒºæ ·å¼ */
        .search-filter-section {
            padding: 16px 24px;
            border-bottom: 1px solid #e2e8f0;
            background: #f8fafc;
            flex-shrink: 0; /* é˜²æ­¢æ”¶ç¼© */
        }

        .filter-row {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-bottom: 8px;
        }

        .filter-row:last-child {
            margin-bottom: 0;
        }

        .date-input {
            padding: 6px 8px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 13px;
            background: #ffffff;
        }

        .filter-hint {
            color: #64748b;
            font-size: 12px;
            margin-left: auto;
        }

        /* çŠ¶æ€å¾½ç« æ ·å¼ */
        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .status-success {
            background: #dcfce7;
            color: #166534;
        }

        .status-warning {
            background: #fef3c7;
            color: #92400e;
        }

        .status-info {
            background: #dbeafe;
            color: #1e40af;
        }

        .status-processing {
            background: #e0e7ff;
            color: #3730a3;
        }

        /* é¡¹ç›®é“¾æ¥æ ·å¼ */
        .project-link {
            color: var(--primary-color);
            font-weight: 500;
        }

        .unlinked-text {
            color: #ef4444;
            font-weight: 500;
        }

        /* é€‰æ‹©ä¿¡æ¯æ ·å¼ */
        .selection-info {
            color: #64748b;
            font-size: 13px;
        }

        /* æ•°æ®å¯¼å…¥æ¨¡å—ç‰¹æ®Šå¸ƒå±€ */
        .import-table-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-height: 0;
        }

        /* å¯¼å…¥è¯´æ˜æ ·å¼ */
        .import-note {
            padding: 12px 16px;
            background: #f0f9ff;
            border-top: 1px solid #e2e8f0;
            color: #0369a1;
            font-size: 12px;
            text-align: center;
            flex-shrink: 0; /* é˜²æ­¢æ”¶ç¼© */
        }

        /* æ¨¡æ€å¯¹è¯æ¡†æ ·å¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-hover);
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: var(--transition);
        }

        .modal-overlay.show .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-muted);
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            transition: var(--transition);
        }

        .modal-close:hover {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
        }

        .modal-body {
            padding: 24px;
        }

        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid var(--border-light);
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--text-primary);
            font-size: 14px;
        }

        .form-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            transition: var(--transition);
            background: var(--bg-primary);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        /* éšè—ç±» */
        .hidden {
            display: none !important;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .sidebar {
                width: 240px;
            }
            .toolbar-right {
                flex-wrap: wrap;
            }
        }

        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            .sidebar {
                width: 100%;
                height: auto;
            }
            .nav-menu {
                display: flex;
                overflow-x: auto;
                padding: 10px;
            }
            .nav-item {
                min-width: 100px;
                text-align: center;
                flex-direction: column;
                padding: 8px;
            }
            .nav-icon {
                margin-right: 0;
                margin-bottom: 4px;
            }
            .filter-row {
                flex-wrap: wrap;
            }
            .toolbar-left, .toolbar-right {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div id="app" class="app-container">
        <!-- å·¦ä¾§å¯¼èˆªæ  -->
        <div class="sidebar">
            <div class="logo-section">
                <div class="logo-title">ç®¡ç†ç³»ç»Ÿ</div>
                <div class="logo-subtitle">Management System</div>
            </div>

            <nav class="nav-menu">
                <div class="nav-item" :class="{active: currentModule === 'project'}" @click="switchModule('project')">
                    <span class="nav-icon">ğŸ“Š</span>
                    <span class="nav-text">é¡¹ç›®ç®¡ç†</span>
                    <span class="nav-badge">{{ projectStats.total }}</span>
                </div>

                <div class="nav-item" :class="{active: currentModule === 'field'}" @click="switchModule('field')">
                    <span class="nav-icon">âš™ï¸</span>
                    <span class="nav-text">å­—æ®µç®¡ç†</span>
                    <span class="nav-badge">{{ fieldStats.total }}</span>
                </div>

                <div class="nav-item" :class="{active: currentModule === 'import'}" @click="switchModule('import')">
                    <span class="nav-icon">ğŸ“¥</span>
                    <span class="nav-text">æ•°æ®å¯¼å…¥</span>
                    <span class="nav-badge">{{ importStats.total }}</span>
                </div>

                <div class="nav-item" :class="{active: currentModule === 'contract'}" @click="switchModule('contract')">
                    <span class="nav-icon">ğŸ“‹</span>
                    <span class="nav-text">åˆåŒæ•°æ®</span>
                    <span class="nav-badge">{{ contractStats.total }}</span>
                </div>

                <div class="nav-item" :class="{active: currentModule === 'procurement'}" @click="switchModule('procurement')">
                    <span class="nav-icon">ğŸ“¦</span>
                    <span class="nav-text">é‡‡è´­æ•°æ®</span>
                    <span class="nav-badge">{{ procurementStats.total }}</span>
                </div>
            </nav>
        </div>

        <!-- å³ä¾§å†…å®¹åŒºåŸŸ -->
        <div class="main-content">


            <!-- é¡¹ç›®ç®¡ç†æ¨¡å— -->
            <div v-if="currentModule === 'project'" class="module-content">
                <!-- é¡µé¢æ ‡é¢˜åŒº -->
                <div class="page-header">
                    <div class="page-title">
                        <span class="page-icon">ğŸ“Š</span>
                        é¡¹ç›®ç®¡ç†
                    </div>

                    <div class="page-stats">
                        ğŸ“ˆ ç»Ÿè®¡: æ€»é¡¹ç›® {{ projectStats.total }} | å·²å…³è” {{ projectStats.linked }} | æœªå…³è” {{ projectStats.unlinked }}
                    </div>
                </div>

                <!-- æ“ä½œå·¥å…·æ  -->
                <div class="action-toolbar">
                    <div class="toolbar-left">
                        <button class="btn btn-primary" @click="showProjectDialog()">+ æ–°å»ºé¡¹ç›®</button>
                        <button class="btn btn-secondary" @click="refreshProjects">ğŸ”„ åˆ·æ–°</button>
                        <button class="btn btn-secondary" @click="exportProjects">ğŸ“¤ å¯¼å‡º</button>
                    </div>
                    <div class="toolbar-right">
                        <div class="search-group">
                            <span class="search-icon">ğŸ”</span>
                            <input type="text" class="search-input" v-model="projectSearch" placeholder="æœç´¢é¡¹ç›®ç¼–å·/åç§°/åˆ«å">
                        </div>
                        <select class="filter-select">
                            <option>ç­›é€‰â–¼</option>
                        </select>
                    </div>
                </div>

                <!-- æ•°æ®è¡¨æ ¼åŒº -->
                <div class="table-section">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>åºå·</th>
                                <th>é¡¹ç›®ç¼–å·</th>
                                <th>é¡¹ç›®åç§°</th>
                                <th>é¡¹ç›®åˆ«å</th>
                                <th>åˆåŒæ•°</th>
                                <th>é‡‡è´­æ•°</th>
                                <th>åˆ›å»ºæ—¶é—´</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="(project, index) in filteredProjects" :key="project.id">
                                <td>{{ index + 1 }}</td>
                                <td>{{ project.code }}</td>
                                <td>{{ project.name }}</td>
                                <td>{{ project.alias }}</td>
                                <td>{{ project.contractCount }}</td>
                                <td>{{ project.procurementCount }}</td>
                                <td>{{ project.createdAt }}</td>
                                <td>
                                    <button class="btn-action" @click="editProject(project)">ç¼–è¾‘</button>
                                    <button class="btn-action" @click="viewProject(project)">è¯¦æƒ…</button>
                                    <button class="btn-action" @click="deleteProject(project)" style="color: #ef4444;">åˆ é™¤</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- çŠ¶æ€æ åŒºåŸŸ -->
                <div class="status-bar">
                    <div class="status-info">å…± {{ projectStats.total }} æ¡è®°å½•</div>
                    <div class="pagination-controls">
                        <button class="page-btn" @click="prevPage" :disabled="currentPage === 1">< ä¸Šä¸€é¡µ</button>
                        <span class="page-info">ç¬¬ {{ currentPage }}/{{ totalPages }} é¡µ</span>
                        <button class="page-btn" @click="nextPage" :disabled="currentPage === totalPages">ä¸‹ä¸€é¡µ ></button>
                        <select class="page-size-select">
                            <option>10â–¼</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- å­—æ®µç®¡ç†æ¨¡å— -->
            <div v-if="currentModule === 'field'" class="module-content">
                <!-- é¡µé¢æ ‡é¢˜åŒº -->
                <div class="page-header">
                    <div class="page-title">
                        <span class="page-icon">âš™ï¸</span>
                        å­—æ®µç®¡ç†
                    </div>

                    <div class="page-stats">
                        ğŸ“Š ç»Ÿè®¡: åˆåŒå­—æ®µ {{ fieldStats.contract }} ä¸ª | é‡‡è´­å­—æ®µ {{ fieldStats.procurement }} ä¸ª | æ€»è®¡ {{ fieldStats.total }} ä¸ª
                    </div>
                </div>

                <!-- æ ‡ç­¾é¡µåˆ‡æ¢ -->
                <div class="tab-section">
                    <div class="tab-buttons">
                        <button class="tab-btn" :class="{active: fieldType === 'contract'}" @click="switchFieldType('contract')">ğŸ“‹ åˆåŒå­—æ®µ</button>
                        <button class="tab-btn" :class="{active: fieldType === 'procurement'}" @click="switchFieldType('procurement')">ğŸ“¦ é‡‡è´­å­—æ®µ</button>
                    </div>
                </div>

                <!-- æ“ä½œå·¥å…·æ  -->
                <div class="action-toolbar">
                    <div class="toolbar-left">
                        <button class="btn btn-primary" @click="showFieldDialog()">+ æ–°å¢å­—æ®µ</button>
                        <button class="btn btn-secondary" @click="importFields">ğŸ“¥ å¯¼å…¥å­—æ®µ</button>
                        <button class="btn btn-secondary" @click="exportFields">ğŸ“¤ å¯¼å‡ºå­—æ®µ</button>
                    </div>
                    <div class="toolbar-right">
                        <div class="search-group">
                            <span class="search-icon">ğŸ”</span>
                            <input type="text" class="search-input" v-model="fieldSearch" placeholder="æœç´¢å­—æ®µåç§°/åˆ«å">
                        </div>
                    </div>
                </div>

                <!-- æ•°æ®è¡¨æ ¼åŒº -->
                <div class="table-section">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>åºå·</th>
                                <th>å­—æ®µåç§°</th>
                                <th>å­—æ®µç±»å‹</th>
                                <th>åˆ«ååˆ—è¡¨</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="(field, index) in filteredFields" :key="field.id">
                                <td>{{ index + 1 }}</td>
                                <td>{{ field.name }}</td>
                                <td>{{ field.type }}</td>
                                <td>{{ field.aliases.join(', ') }}</td>
                                <td>
                                    <button class="btn-action" @click="editField(field)">ç¼–è¾‘</button>
                                    <button class="btn-action" @click="deleteField(field)">åˆ é™¤</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- çŠ¶æ€æ åŒºåŸŸ -->
                <div class="status-bar">
                    <div class="status-info">å½“å‰åˆ†ç±»: {{ fieldType === 'contract' ? 'åˆåŒå­—æ®µ' : 'é‡‡è´­å­—æ®µ' }} | å…± {{ filteredFields.length }} ä¸ªå­—æ®µ</div>
                    <div class="pagination-controls">
                        <select class="filter-select">
                            <option>æ‰¹é‡æ“ä½œâ–¼</option>
                        </select>
                        <button class="btn btn-secondary">åˆ·æ–°</button>
                    </div>
                </div>
            </div>

            <!-- æ•°æ®å¯¼å…¥æ¨¡å— -->
            <div v-if="currentModule === 'import'" class="module-content">
                <!-- é¡µé¢æ ‡é¢˜åŒº -->
                <div class="page-header">
                    <div class="page-title">
                        <span class="page-icon">ğŸ“¥</span>
                        æ•°æ®å¯¼å…¥
                    </div>

                    <div class="page-stats">
                        ğŸ“Š ç»Ÿè®¡: æ€»æ–‡ä»¶ {{ importStats.total }} | å·¥ä½œè¡¨æ€»æ•° {{ importStats.totalSheets }}
                    </div>
                </div>

                <!-- æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ -->
                <div class="upload-section-compact">
                    <div class="upload-area-compact" @dragover.prevent @drop.prevent="handleDrop">
                        <div class="upload-content-compact" style="text-align: center;">
                            <div class="upload-icon">ğŸ“</div>
                            <div class="upload-text">æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„æˆ–ç‚¹å‡»é€‰æ‹© (æ”¯æŒ .xlsx, .xls æ ¼å¼ï¼Œæœ€å¤§50MB)</div>
                        </div>
                    </div>
                </div>

                <!-- æ“ä½œå·¥å…·æ  -->
                <div class="action-toolbar">
                    <div class="toolbar-left">
                        <button class="btn btn-primary" @click="selectFiles">ğŸ“‚ é€‰æ‹©æ–‡ä»¶</button>
                        <button class="btn btn-secondary" @click="selectFolder">ğŸ“ é€‰æ‹©æ–‡ä»¶å¤¹</button>
                        <button class="btn btn-secondary" @click="clearFiles">ğŸ—‘ï¸ æ¸…ç©ºåˆ—è¡¨</button>
                    </div>
                    <div class="toolbar-right">
                        <button class="btn btn-secondary" @click="showImportSettings">âš™ï¸ å¯¼å…¥è®¾ç½®</button>
                        <button class="btn btn-secondary" @click="updateAllFiles">ğŸ”„ æ›´æ–°æ‰€æœ‰æ–‡ä»¶</button>
                    </div>
                </div>

                <!-- æ–‡ä»¶åˆ—è¡¨åŒº -->
                <div class="import-table-section">
                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>åºå·</th>
                                    <th>æ–‡ä»¶å</th>
                                    <th>å¤§å°</th>
                                    <th>å·¥ä½œè¡¨æ•°</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(file, index) in importFileList" :key="file.id">
                                    <td>{{ index + 1 }}</td>
                                    <td>{{ file.name }}</td>
                                    <td>{{ file.size }}</td>
                                    <td>{{ file.sheetCount }}</td>
                                    <td>
                                        <button class="btn-action" @click="viewFileDetail(file)">ğŸ“‹ æŸ¥çœ‹è¯¦æƒ…</button>
                                        <button class="btn-action" @click="deleteFile(file)">ğŸ—‘ï¸ åˆ é™¤</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="import-note" style="text-align: center;">
                        ğŸ’¡ è¯´æ˜: ç‚¹å‡»"æŸ¥çœ‹è¯¦æƒ…"å¯æŸ¥çœ‹æ–‡ä»¶ä¸­æ‰€æœ‰å·¥ä½œè¡¨çš„è¯†åˆ«æƒ…å†µå’Œæ•°æ®ç»Ÿè®¡
                    </div>
                </div>

                <!-- çŠ¶æ€æ åŒºåŸŸ -->
                <div class="status-bar">
                    <div class="status-info">å·²å¯¼å…¥ {{ importStats.total }} ä¸ªæ–‡ä»¶ | å·¥ä½œè¡¨æ€»æ•° {{ importStats.totalSheets }} ä¸ª</div>
                </div>
            </div>

            <!-- åˆåŒç®¡ç†æ¨¡å— -->
            <div v-if="currentModule === 'contract'" class="module-content">
                <!-- é¡µé¢æ ‡é¢˜åŒº -->
                <div class="page-header">
                    <div class="page-title">
                        <span class="page-icon">ğŸ“‹</span>
                        åˆåŒæ•°æ®
                    </div>

                    <div class="page-stats">
                        ğŸ“Š ç»Ÿè®¡: æ€»åˆåŒ {{ contractStats.total }} | å·²å…³è” {{ contractStats.linked }} | æœªå…³è” {{ contractStats.unlinked }} | ä»Šæ—¥æ–°å¢ {{ contractStats.todayNew }}
                    </div>
                </div>

                <!-- æœç´¢ç­›é€‰åŒº -->
                <div class="search-filter-section">
                    <div class="filter-row">
                        <div class="search-group">
                            <span class="search-icon">ğŸ”</span>
                            <input type="text" class="search-input" v-model="contractSearch" placeholder="æœç´¢åˆåŒç¼–å·/åç§°">
                        </div>
                        <select class="filter-select">
                            <option>é¡¹ç›®â–¼</option>
                        </select>
                        <div class="search-group">
                            <span>ç”²æ–¹:</span>
                            <input type="text" class="search-input" placeholder="åä¸º,è…¾è®¯,é˜¿é‡Œ">
                        </div>
                        <div class="search-group">
                            <input type="text" class="search-input" placeholder="ä¹™æ–¹">
                        </div>
                    </div>
                    <div class="filter-row">
                        <span>ğŸ“… ç­¾çº¦æ—¥æœŸ:</span>
                        <input type="date" class="date-input" value="2024-01-01">
                        <span>è‡³</span>
                        <input type="date" class="date-input" value="2024-12-31">
                        <button class="btn btn-secondary" @click="showAdvancedFilter">ğŸ” é«˜çº§ç­›é€‰</button>
                        <button class="btn btn-secondary" @click="resetFilters">ğŸ”„ é‡ç½®</button>
                        <span class="filter-hint">ğŸ’¡ é€—å·åˆ†éš”OR</span>
                    </div>
                </div>

                <!-- æ“ä½œå·¥å…·æ  -->
                <div class="action-toolbar">
                    <div class="toolbar-left">
                        <button class="btn btn-secondary" @click="showColumnConfig">âš™ï¸ åˆ—é…ç½®</button>
                        <button class="btn btn-secondary" @click="exportContracts">ğŸ“¤ å¯¼å‡º</button>
                        <button class="btn btn-secondary" @click="batchOperations">ğŸ“¦ æ‰¹é‡æ“ä½œ</button>
                        <button class="btn btn-secondary" @click="refreshContracts">ğŸ”„ åˆ·æ–°</button>
                        <button class="btn btn-secondary" @click="switchView">ğŸ“Š è§†å›¾åˆ‡æ¢</button>
                    </div>
                    <div class="toolbar-right">
                        <span class="selection-info">å·²é€‰æ‹© {{ selectedContracts.length }} é¡¹</span>
                    </div>
                </div>

                <!-- æ•°æ®è¡¨æ ¼åŒº -->
                <div class="table-section">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th><input type="checkbox" v-model="selectAll" @change="toggleSelectAll"></th>
                                <th>åºå·</th>
                                <th>åˆåŒç¼–å·</th>
                                <th>å…³è”é¡¹ç›®</th>
                                <th>ç”²æ–¹</th>
                                <th>ä¹™æ–¹</th>
                                <th>ç­¾çº¦æ—¥æœŸ</th>
                                <th>åˆåŒé‡‘é¢</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="(contract, index) in filteredContracts" :key="contract.id">
                                <td><input type="checkbox" v-model="selectedContracts" :value="contract.id"></td>
                                <td>{{ index + 1 }}</td>
                                <td>{{ contract.number }}</td>
                                <td>
                                    <span v-if="contract.projectName" class="project-link">{{ contract.projectName }}</span>
                                    <span v-else class="unlinked-text">æœªå…³è”</span>
                                </td>
                                <td>{{ contract.partyA }}</td>
                                <td>{{ contract.partyB }}</td>
                                <td>{{ contract.signDate }}</td>
                                <td>{{ contract.amount }}</td>
                                <td>
                                    <button class="btn-action" @click="viewContract(contract)">è¯¦æƒ…</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- çŠ¶æ€æ åŒºåŸŸ -->
                <div class="status-bar">
                    <div class="status-info">å·²é€‰æ‹© {{ selectedContracts.length }} é¡¹ | ç­›é€‰ç»“æœ {{ filteredContracts.length }} æ¡ | å…± {{ contractStats.total }} æ¡è®°å½•</div>
                    <div class="pagination-controls">
                        <button class="page-btn" @click="prevPage" :disabled="currentPage === 1">< ä¸Šä¸€é¡µ</button>
                        <span class="page-info">ç¬¬ {{ currentPage }}/{{ totalPages }} é¡µ</span>
                        <button class="page-btn" @click="nextPage" :disabled="currentPage === totalPages">ä¸‹ä¸€é¡µ ></button>
                    </div>
                </div>
            </div>

            <!-- é‡‡è´­ç®¡ç†æ¨¡å— -->
            <div v-if="currentModule === 'procurement'" class="module-content">
                <!-- é¡µé¢æ ‡é¢˜åŒº -->
                <div class="page-header">
                    <div class="page-title">
                        <span class="page-icon">ğŸ“¦</span>
                        é‡‡è´­æ•°æ®
                    </div>

                    <div class="page-stats">
                        ğŸ“Š ç»Ÿè®¡: æ€»é‡‡è´­ {{ procurementStats.total }} | å·²å…³è” {{ procurementStats.linked }} | æœªå…³è” {{ procurementStats.unlinked }}
                    </div>
                </div>

                <!-- æœç´¢ç­›é€‰åŒº -->
                <div class="search-filter-section">
                    <div class="filter-row">
                        <div class="search-group">
                            <span class="search-icon">ğŸ”</span>
                            <input type="text" class="search-input" v-model="procurementSearch" placeholder="æœç´¢é‡‡è´­ç¼–å·/ä¾›åº”å•†">
                        </div>
                        <select class="filter-select">
                            <option>é¡¹ç›®â–¼</option>
                        </select>
                        <div class="search-group">
                            <span>ä¾›åº”å•†:</span>
                            <input type="text" class="search-input" placeholder="åä¸º,è…¾è®¯,é˜¿é‡Œ">
                        </div>
                        <div class="search-group">
                            <input type="text" class="search-input" placeholder="é‡‡è´­å†…å®¹">
                        </div>
                    </div>
                    <div class="filter-row">
                        <span>ğŸ“… é‡‡è´­æ—¥æœŸ:</span>
                        <input type="date" class="date-input" value="2024-01-01">
                        <span>è‡³</span>
                        <input type="date" class="date-input" value="2024-12-31">
                        <button class="btn btn-secondary" @click="showAdvancedFilter">ğŸ” é«˜çº§ç­›é€‰</button>
                        <button class="btn btn-secondary" @click="resetFilters">ğŸ”„ é‡ç½®</button>
                        <span class="filter-hint">ğŸ’¡ é€—å·åˆ†éš”OR</span>
                    </div>
                </div>

                <!-- æ“ä½œå·¥å…·æ  -->
                <div class="action-toolbar">
                    <div class="toolbar-left">
                        <button class="btn btn-secondary" @click="showColumnConfig">âš™ï¸ åˆ—é…ç½®</button>
                        <button class="btn btn-secondary" @click="exportProcurements">ğŸ“¤ å¯¼å‡º</button>
                        <button class="btn btn-secondary" @click="batchOperations">ğŸ“¦ æ‰¹é‡æ“ä½œ</button>
                        <button class="btn btn-secondary" @click="refreshProcurements">ğŸ”„ åˆ·æ–°</button>
                        <button class="btn btn-secondary" @click="switchView">ğŸ“Š è§†å›¾åˆ‡æ¢</button>
                    </div>
                    <div class="toolbar-right">
                        <span class="selection-info">å·²é€‰æ‹© {{ selectedProcurements.length }} é¡¹</span>
                    </div>
                </div>

                <!-- æ•°æ®è¡¨æ ¼åŒº -->
                <div class="table-section">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th><input type="checkbox" v-model="selectAllProcurements" @change="toggleSelectAllProcurements"></th>
                                <th>åºå·</th>
                                <th>é‡‡è´­ç¼–å·</th>
                                <th>å…³è”é¡¹ç›®</th>
                                <th>ä¾›åº”å•†</th>
                                <th>é‡‡è´­å†…å®¹</th>
                                <th>é‡‡è´­é‡‘é¢</th>
                                <th>é‡‡è´­æ—¥æœŸ</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="(procurement, index) in filteredProcurements" :key="procurement.id">
                                <td><input type="checkbox" v-model="selectedProcurements" :value="procurement.id"></td>
                                <td>{{ index + 1 }}</td>
                                <td>{{ procurement.number }}</td>
                                <td>
                                    <span v-if="procurement.projectName" class="project-link">{{ procurement.projectName }}</span>
                                    <span v-else class="unlinked-text">æœªå…³è”</span>
                                </td>
                                <td>{{ procurement.supplier }}</td>
                                <td>{{ procurement.content }}</td>
                                <td>{{ procurement.amount }}</td>
                                <td>{{ procurement.date }}</td>
                                <td>
                                    <button class="btn-action" @click="viewProcurement(procurement)">è¯¦æƒ…</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- çŠ¶æ€æ åŒºåŸŸ -->
                <div class="status-bar">
                    <div class="status-info">å·²é€‰æ‹© {{ selectedProcurements.length }} é¡¹ | ç­›é€‰ç»“æœ {{ filteredProcurements.length }} æ¡ | å…± {{ procurementStats.total }} æ¡è®°å½•</div>
                    <div class="pagination-controls">
                        <button class="page-btn" @click="prevPage" :disabled="currentPage === 1">< ä¸Šä¸€é¡µ</button>
                        <span class="page-info">ç¬¬ {{ currentPage }}/{{ totalPages }} é¡µ</span>
                        <button class="page-btn" @click="nextPage" :disabled="currentPage === totalPages">ä¸‹ä¸€é¡µ ></button>
                    </div>
                </div>
            </div>
        </div>

        <!-- é¡¹ç›®ç¼–è¾‘æ¨¡æ€æ¡† -->
        <div class="modal-overlay" :class="{show: showProjectModal}" @click.self="closeProjectModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">{{ editingProject.id ? 'ç¼–è¾‘é¡¹ç›®' : 'æ–°å»ºé¡¹ç›®' }}</h3>
                    <button class="modal-close" @click="closeProjectModal">Ã—</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">é¡¹ç›®ç¼–å·</label>
                        <input type="text" class="form-input" v-model="editingProject.code" placeholder="è¯·è¾“å…¥é¡¹ç›®ç¼–å·">
                    </div>
                    <div class="form-group">
                        <label class="form-label">é¡¹ç›®åç§°</label>
                        <input type="text" class="form-input" v-model="editingProject.name" placeholder="è¯·è¾“å…¥é¡¹ç›®åç§°">
                    </div>
                    <div class="form-group">
                        <label class="form-label">é¡¹ç›®åˆ«å</label>
                        <input type="text" class="form-input" v-model="editingProject.alias" placeholder="å¤šä¸ªåˆ«åç”¨é€—å·åˆ†éš”">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="closeProjectModal">å–æ¶ˆ</button>
                    <button class="btn btn-primary" @click="saveProject">ä¿å­˜</button>
                </div>
            </div>
        </div>

        <!-- å­—æ®µç¼–è¾‘æ¨¡æ€æ¡† -->
        <div class="modal-overlay" :class="{show: showFieldModal}" @click.self="closeFieldModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">{{ editingField.id ? 'ç¼–è¾‘å­—æ®µ' : 'æ–°å¢å­—æ®µ' }}</h3>
                    <button class="modal-close" @click="closeFieldModal">Ã—</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">å­—æ®µåç§°</label>
                        <input type="text" class="form-input" v-model="editingField.name" placeholder="è¯·è¾“å…¥å­—æ®µåç§°">
                    </div>
                    <div class="form-group">
                        <label class="form-label">å­—æ®µç±»å‹</label>
                        <select class="form-input" v-model="editingField.type">
                            <option value="">è¯·é€‰æ‹©å­—æ®µç±»å‹</option>
                            <option v-for="type in fieldTypes" :key="type" :value="type">{{ type }}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">å­—æ®µåˆ«å</label>
                        <textarea class="form-input form-textarea" v-model="editingField.aliasText" placeholder="å¤šä¸ªåˆ«åç”¨é€—å·åˆ†éš”ï¼Œå¦‚ï¼šç¼–å·,åˆåŒå·,åºå·"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="closeFieldModal">å–æ¶ˆ</button>
                    <button class="btn btn-primary" @click="saveField">ä¿å­˜</button>
                </div>
            </div>
        </div>

        <!-- å¯¼å…¥è®¾ç½®æ¨¡æ€æ¡† -->
        <div class="modal-overlay" :class="{show: showImportSettingsModal}" @click.self="closeImportSettingsModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">å¯¼å…¥è®¾ç½®</h3>
                    <button class="modal-close" @click="closeImportSettingsModal">Ã—</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">ğŸ“‹ åŒ¹é…æ¨¡å¼</label>
                        <select class="form-input" v-model="importSettings.matchMode">
                            <option value="strict">ç²¾ç¡®åŒ¹é… - ä»…åŒ¹é…å®Œå…¨ç›¸åŒçš„å­—æ®µåç§°</option>
                            <option value="fuzzy">æ¨¡ç³ŠåŒ¹é… - æ”¯æŒç›¸ä¼¼å­—æ®µåç§°åŒ¹é…</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ğŸ”¢ æœ€å°‘åŒ¹é…å­—æ®µæ•°</label>
                        <input type="number" class="form-input" v-model="importSettings.minMatchFields" min="1" placeholder="è¯·è¾“å…¥æœ€å°‘åŒ¹é…å­—æ®µæ•°">
                    </div>
                    <div class="form-group">
                        <label class="form-label">âš™ï¸ å…¶ä»–è®¾ç½®</label>
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" v-model="importSettings.skipEmptyRows"> è·³è¿‡ç©ºè¡Œ
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" v-model="importSettings.trimWhitespace"> è‡ªåŠ¨å»é™¤ç©ºæ ¼
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" v-model="importSettings.validateData"> å¯ç”¨æ•°æ®éªŒè¯
                            </label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" @click="closeImportSettingsModal">å–æ¶ˆ</button>
                    <button class="btn btn-primary" @click="saveImportSettings">ä¿å­˜è®¾ç½®</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        // é…ç½®å¸¸é‡
        const CONFIG = {
            PAGE_SIZE: 10,
            MAX_FILE_SIZE: 50 * 1024 * 1024, // 50MB
            ALLOWED_EXTENSIONS: ['.xlsx', '.xls'],
            FIELD_TYPES: ['æ–‡æœ¬', 'æ•°å­—', 'æ—¥æœŸ', 'é‡‘é¢', 'é€‰æ‹©', 'é•¿æ–‡æœ¬'],
            SYSTEM_TITLES: {
                'project': 'é¡¹ç›®ç®¡ç†',
                'field': 'å­—æ®µç®¡ç†',
                'import': 'æ•°æ®å¯¼å…¥',
                'contract': 'åˆåŒæ•°æ®',
                'procurement': 'é‡‡è´­æ•°æ®'
            }
        };

        createApp({
            data() {
                return {
                    // å½“å‰æ¨¡å—
                    currentModule: 'project',

                    // æœç´¢æ¡ä»¶
                    projectSearch: '',
                    fieldSearch: '',
                    contractSearch: '',
                    procurementSearch: '',

                    // å­—æ®µç®¡ç†
                    fieldType: 'contract',

                    // åˆ†é¡µ
                    currentPage: 1,
                    pageSize: CONFIG.PAGE_SIZE,

                    // é€‰æ‹©çŠ¶æ€
                    selectAll: false,
                    selectedContracts: [],
                    selectAllProcurements: false,
                    selectedProcurements: [],

                    // æ¨¡æ€æ¡†çŠ¶æ€
                    showProjectModal: false,
                    showFieldModal: false,
                    showImportSettingsModal: false,
                    editingProject: {},
                    editingField: {},

                    // é…ç½®æ•°æ®
                    fieldTypes: ['æ–‡æœ¬', 'æ•°å­—', 'æ—¥æœŸ', 'é‡‘é¢', 'é€‰æ‹©', 'é•¿æ–‡æœ¬'],

                    // å¯¼å…¥è®¾ç½®
                    importSettings: {
                        matchMode: 'strict',
                        minMatchFields: 3,
                        skipEmptyRows: true,
                        trimWhitespace: true,
                        validateData: true
                    },

                    // ç»Ÿè®¡æ•°æ®
                    projectStats: {
                        total: 156,
                        linked: 89,
                        unlinked: 67
                    },
                    fieldStats: {
                        total: 43,
                        contract: 25,
                        procurement: 18
                    },
                    importStats: {
                        total: 15,
                        totalSheets: 42
                    },
                    contractStats: {
                        total: 1256,
                        linked: 892,
                        unlinked: 364,
                        todayNew: 15
                    },
                    procurementStats: {
                        total: 892,
                        linked: 567,
                        unlinked: 325
                    },

                    // æ•°æ®åˆ—è¡¨
                    projectList: [
                        {
                            id: 1,
                            code: 'PRJ-2024-001',
                            name: 'æ™ºæ…§åŸå¸‚å»ºè®¾é¡¹ç›®',
                            alias: 'æ™ºæ…§åŸå¸‚',
                            contractCount: 12,
                            procurementCount: 8,
                            createdAt: '2024-01-15'
                        },
                        {
                            id: 2,
                            code: 'PRJ-2024-002',
                            name: 'æ•°æ®ä¸­å¿ƒå‡çº§æ”¹é€ ',
                            alias: 'æ•°æ®ä¸­å¿ƒ',
                            contractCount: 5,
                            procurementCount: 3,
                            createdAt: '2024-01-16'
                        },
                        {
                            id: 3,
                            code: 'PRJ-2024-003',
                            name: 'åŠå…¬æ¥¼è£…ä¿®å·¥ç¨‹',
                            alias: 'åŠå…¬è£…ä¿®',
                            contractCount: 8,
                            procurementCount: 6,
                            createdAt: '2024-01-17'
                        },
                        {
                            id: 4,
                            code: 'PRJ-2024-004',
                            name: 'ç½‘ç»œå®‰å…¨ç³»ç»Ÿéƒ¨ç½²',
                            alias: 'ç½‘ç»œå®‰å…¨',
                            contractCount: 3,
                            procurementCount: 2,
                            createdAt: '2024-01-18'
                        },
                        {
                            id: 5,
                            code: 'PRJ-2024-005',
                            name: 'äº‘å¹³å°è¿ç§»é¡¹ç›®',
                            alias: 'äº‘è¿ç§»',
                            contractCount: 7,
                            procurementCount: 4,
                            createdAt: '2024-01-19'
                        }
                    ],

                    contractFieldList: [
                        { id: 1, name: 'åˆåŒç¼–å·', type: 'æ–‡æœ¬', aliases: ['ç¼–å·', 'åˆåŒå·'] },
                        { id: 2, name: 'é¡¹ç›®åç§°', type: 'æ–‡æœ¬', aliases: ['é¡¹ç›®', 'å·¥ç¨‹åç§°'] },
                        { id: 3, name: 'ç”²æ–¹å•ä½', type: 'æ–‡æœ¬', aliases: ['ç”²æ–¹', 'å§”æ‰˜æ–¹'] },
                        { id: 4, name: 'ä¹™æ–¹å•ä½', type: 'æ–‡æœ¬', aliases: ['ä¹™æ–¹', 'æ‰¿åŒ…æ–¹'] },
                        { id: 5, name: 'ç­¾çº¦æ—¥æœŸ', type: 'æ—¥æœŸ', aliases: ['ç­¾ç½²æ—¥æœŸ', 'åˆåŒæ—¥æœŸ'] },
                        { id: 6, name: 'åˆåŒé‡‘é¢', type: 'é‡‘é¢', aliases: ['é‡‘é¢', 'æ€»ä»·'] },
                        { id: 7, name: 'åˆåŒçŠ¶æ€', type: 'é€‰æ‹©', aliases: ['çŠ¶æ€', 'è¿›åº¦'] },
                        { id: 8, name: 'å¤‡æ³¨ä¿¡æ¯', type: 'é•¿æ–‡æœ¬', aliases: ['å¤‡æ³¨', 'è¯´æ˜'] }
                    ],

                    procurementFieldList: [
                        { id: 9, name: 'é‡‡è´­ç¼–å·', type: 'æ–‡æœ¬', aliases: ['ç¼–å·', 'é‡‡è´­å·'] },
                        { id: 10, name: 'ä¾›åº”å•†', type: 'æ–‡æœ¬', aliases: ['ä¾›åº”å•†åç§°', 'å‚å•†'] },
                        { id: 11, name: 'é‡‡è´­é‡‘é¢', type: 'é‡‘é¢', aliases: ['é‡‘é¢', 'æ€»ä»·'] },
                        { id: 12, name: 'é‡‡è´­æ—¥æœŸ', type: 'æ—¥æœŸ', aliases: ['é‡‡è´­æ—¶é—´', 'ä¸‹å•æ—¥æœŸ'] }
                    ],

                    importFileList: [
                        {
                            id: 1,
                            name: 'åˆåŒæ•°æ®.xlsx',
                            size: '2MB',
                            sheetCount: 3
                        },
                        {
                            id: 2,
                            name: 'é‡‡è´­æ¸…å•.xlsx',
                            size: '1MB',
                            sheetCount: 2
                        },
                        {
                            id: 3,
                            name: 'ä¾›åº”å•†ä¿¡æ¯.xlsx',
                            size: '3MB',
                            sheetCount: 1
                        },
                        {
                            id: 4,
                            name: 'é¡¹ç›®æ•°æ®.xlsx',
                            size: '1MB',
                            sheetCount: 4
                        },
                        {
                            id: 5,
                            name: 'è´¢åŠ¡æŠ¥è¡¨.xlsx',
                            size: '2MB',
                            sheetCount: 2
                        },
                        {
                            id: 6,
                            name: 'è®¾å¤‡æ¸…å•.xlsx',
                            size: '1MB',
                            sheetCount: 3
                        },
                        {
                            id: 7,
                            name: 'æ–°åˆåŒ.xlsx',
                            size: '2MB',
                            sheetCount: 5
                        }
                    ],

                    contractList: [
                        {
                            id: 1,
                            number: 'CON-2024-001',
                            projectName: 'æ™ºæ…§åŸå¸‚å»ºè®¾é¡¹ç›®',
                            partyA: 'å¸‚æ”¿åºœ',
                            partyB: 'åä¸ºå…¬å¸',
                            signDate: '2024-01-15',
                            amount: 'Â¥100ä¸‡'
                        },
                        {
                            id: 2,
                            number: 'CON-2024-002',
                            projectName: 'æ•°æ®ä¸­å¿ƒå‡çº§æ”¹é€ ',
                            partyA: 'å¸‚æ”¿åºœ',
                            partyB: 'è…¾è®¯ç§‘æŠ€',
                            signDate: '2024-01-16',
                            amount: 'Â¥200ä¸‡'
                        },
                        {
                            id: 3,
                            number: 'CON-2024-003',
                            projectName: 'åŠå…¬æ¥¼è£…ä¿®å·¥ç¨‹',
                            partyA: 'å¸‚æ”¿åºœ',
                            partyB: 'é˜¿é‡Œå·´å·´',
                            signDate: '2024-01-17',
                            amount: 'Â¥150ä¸‡'
                        },
                        {
                            id: 4,
                            number: 'CON-2024-004',
                            projectName: 'ç½‘ç»œå®‰å…¨ç³»ç»Ÿéƒ¨ç½²',
                            partyA: 'å¸‚æ”¿åºœ',
                            partyB: 'å¥‡å®‰ä¿¡',
                            signDate: '2024-01-18',
                            amount: 'Â¥80ä¸‡'
                        },
                        {
                            id: 5,
                            number: 'CON-2024-005',
                            projectName: 'äº‘å¹³å°è¿ç§»é¡¹ç›®',
                            partyA: 'å¸‚æ”¿åºœ',
                            partyB: 'äº¬ä¸œäº‘',
                            signDate: '2024-01-19',
                            amount: 'Â¥120ä¸‡'
                        },
                        {
                            id: 6,
                            number: 'CON-2024-006',
                            projectName: null,
                            partyA: 'å¸‚æ”¿åºœ',
                            partyB: 'ç™¾åº¦æ™ºèƒ½',
                            signDate: '2024-01-20',
                            amount: 'Â¥90ä¸‡'
                        }
                    ],

                    procurementList: [
                        {
                            id: 1,
                            number: 'PUR-2024-001',
                            projectName: 'æ™ºæ…§åŸå¸‚å»ºè®¾é¡¹ç›®',
                            supplier: 'åä¸ºå…¬å¸',
                            content: 'æœåŠ¡å™¨è®¾å¤‡',
                            amount: 'Â¥50ä¸‡',
                            date: '2024-01-10'
                        },
                        {
                            id: 2,
                            number: 'PUR-2024-002',
                            projectName: 'æ•°æ®ä¸­å¿ƒå‡çº§æ”¹é€ ',
                            supplier: 'è…¾è®¯ç§‘æŠ€',
                            content: 'äº‘æœåŠ¡',
                            amount: 'Â¥30ä¸‡',
                            date: '2024-01-12'
                        },
                        {
                            id: 3,
                            number: 'PUR-2024-003',
                            projectName: 'åŠå…¬æ¥¼è£…ä¿®å·¥ç¨‹',
                            supplier: 'è£…ä¿®å…¬å¸',
                            content: 'è£…ä¿®ææ–™',
                            amount: 'Â¥80ä¸‡',
                            date: '2024-01-14'
                        },
                        {
                            id: 4,
                            number: 'PUR-2024-004',
                            projectName: null,
                            supplier: 'è®¾å¤‡ä¾›åº”å•†',
                            content: 'ç½‘ç»œè®¾å¤‡',
                            amount: 'Â¥25ä¸‡',
                            date: '2024-01-16'
                        }
                    ]
                };
            },

            computed: {
                // è¿‡æ»¤åçš„é¡¹ç›®åˆ—è¡¨
                filteredProjects() {
                    if (!this.projectSearch) return this.projectList;
                    const search = this.projectSearch.toLowerCase();
                    return this.projectList.filter(project =>
                        project.code.toLowerCase().includes(search) ||
                        project.name.toLowerCase().includes(search) ||
                        project.alias.toLowerCase().includes(search)
                    );
                },

                // è¿‡æ»¤åçš„å­—æ®µåˆ—è¡¨
                filteredFields() {
                    const fields = this.fieldType === 'contract' ? this.contractFieldList : this.procurementFieldList;
                    if (!this.fieldSearch) return fields;
                    const search = this.fieldSearch.toLowerCase();
                    return fields.filter(field =>
                        field.name.toLowerCase().includes(search) ||
                        field.aliases.some(alias => alias.toLowerCase().includes(search))
                    );
                },

                // è¿‡æ»¤åçš„åˆåŒåˆ—è¡¨
                filteredContracts() {
                    if (!this.contractSearch) return this.contractList;
                    const search = this.contractSearch.toLowerCase();
                    return this.contractList.filter(contract =>
                        contract.number.toLowerCase().includes(search) ||
                        (contract.projectName && contract.projectName.toLowerCase().includes(search))
                    );
                },

                // è¿‡æ»¤åçš„é‡‡è´­åˆ—è¡¨
                filteredProcurements() {
                    if (!this.procurementSearch) return this.procurementList;
                    const search = this.procurementSearch.toLowerCase();
                    return this.procurementList.filter(procurement =>
                        procurement.number.toLowerCase().includes(search) ||
                        procurement.supplier.toLowerCase().includes(search)
                    );
                },

                // åˆ†é¡µç›¸å…³è®¡ç®—
                totalPages() {
                    return Math.ceil(this.filteredProjects.length / this.pageSize);
                }
            },

            methods: {
                // è·å–ç³»ç»Ÿæ ‡é¢˜
                getSystemTitle() {
                    return CONFIG.SYSTEM_TITLES[this.currentModule] || 'ç³»ç»Ÿç®¡ç†';
                },

                // åˆ‡æ¢æ¨¡å—
                switchModule(module) {
                    this.currentModule = module;
                    this.currentPage = 1;
                },

                // é¡¹ç›®ç®¡ç†æ–¹æ³•
                showProjectDialog(project = null) {
                    this.editingProject = project ? { ...project } : {
                        id: null,
                        code: '',
                        name: '',
                        alias: '',
                        contractCount: 0,
                        procurementCount: 0,
                        createdAt: new Date().toISOString().split('T')[0]
                    };
                    this.showProjectModal = true;
                },

                editProject(project) {
                    this.showProjectDialog(project);
                },

                closeProjectModal() {
                    this.showProjectModal = false;
                    this.editingProject = {};
                },

                saveProject() {
                    if (!this.editingProject.code || !this.editingProject.name) {
                        alert('è¯·å¡«å†™é¡¹ç›®ç¼–å·å’Œé¡¹ç›®åç§°');
                        return;
                    }

                    if (this.editingProject.id) {
                        // ç¼–è¾‘æ¨¡å¼
                        const index = this.projectList.findIndex(p => p.id === this.editingProject.id);
                        if (index > -1) {
                            this.projectList[index] = { ...this.editingProject };
                            alert('é¡¹ç›®æ›´æ–°æˆåŠŸï¼');
                        }
                    } else {
                        // æ–°å»ºæ¨¡å¼
                        this.editingProject.id = Date.now();
                        this.projectList.unshift({ ...this.editingProject });
                        this.projectStats.total++;
                        alert('é¡¹ç›®åˆ›å»ºæˆåŠŸï¼');
                    }

                    this.closeProjectModal();
                },

                deleteProject(project) {
                    if (confirm(`ç¡®å®šåˆ é™¤é¡¹ç›® "${project.name}" å—ï¼Ÿ\n\næ³¨æ„ï¼šåˆ é™¤é¡¹ç›®ä¸ä¼šå½±å“å·²å…³è”çš„åˆåŒå’Œé‡‡è´­æ•°æ®ï¼Œä½†ä¼šè§£é™¤å…³è”å…³ç³»ã€‚`)) {
                        const index = this.projectList.findIndex(p => p.id === project.id);
                        if (index > -1) {
                            this.projectList.splice(index, 1);
                            this.projectStats.total--;
                            // é‡æ–°è®¡ç®—ç»Ÿè®¡æ•°æ®
                            this.projectStats.linked = this.projectList.filter(p => p.contractCount > 0 || p.procurementCount > 0).length;
                            this.projectStats.unlinked = this.projectStats.total - this.projectStats.linked;
                            alert('é¡¹ç›®åˆ é™¤æˆåŠŸï¼');
                        }
                    }
                },

                viewProject(project) {
                    alert(`æŸ¥çœ‹é¡¹ç›®è¯¦æƒ…: ${project.name}\né¡¹ç›®ç¼–å·: ${project.code}\nåˆåŒæ•°: ${project.contractCount}\né‡‡è´­æ•°: ${project.procurementCount}`);
                },

                refreshProjects() {
                    // æ¨¡æ‹Ÿåˆ·æ–°æ•°æ®
                    const loadingMsg = 'æ­£åœ¨åˆ·æ–°é¡¹ç›®æ•°æ®...';
                    console.log(loadingMsg);

                    setTimeout(() => {
                        // æ¨¡æ‹Ÿæ›´æ–°ç»Ÿè®¡æ•°æ®
                        this.projectStats.total = this.projectList.length;
                        this.projectStats.linked = this.projectList.filter(p => p.contractCount > 0 || p.procurementCount > 0).length;
                        this.projectStats.unlinked = this.projectStats.total - this.projectStats.linked;
                        alert('é¡¹ç›®æ•°æ®åˆ·æ–°æˆåŠŸï¼');
                    }, 500);
                },

                exportProjects() {
                    if (this.projectList.length === 0) {
                        alert('æ²¡æœ‰å¯å¯¼å‡ºçš„é¡¹ç›®æ•°æ®');
                        return;
                    }

                    // æ¨¡æ‹Ÿå¯¼å‡ºåŠŸèƒ½
                    const exportData = this.filteredProjects.map(project => ({
                        'é¡¹ç›®ç¼–å·': project.code,
                        'é¡¹ç›®åç§°': project.name,
                        'é¡¹ç›®åˆ«å': project.alias,
                        'åˆåŒæ•°é‡': project.contractCount,
                        'é‡‡è´­æ•°é‡': project.procurementCount,
                        'åˆ›å»ºæ—¶é—´': project.createdAt
                    }));

                    console.log('å¯¼å‡ºæ•°æ®:', exportData);
                    alert(`é¡¹ç›®æ•°æ®å¯¼å‡ºæˆåŠŸï¼å…±å¯¼å‡º ${exportData.length} æ¡è®°å½•`);
                },

                // å­—æ®µç®¡ç†æ–¹æ³•
                switchFieldType(type) {
                    this.fieldType = type;
                    this.fieldSearch = '';
                },

                showFieldDialog(field = null) {
                    this.editingField = field ? {
                        ...field,
                        aliasText: field.aliases.join(', ')
                    } : {
                        id: null,
                        name: '',
                        type: '',
                        aliases: [],
                        aliasText: ''
                    };
                    this.showFieldModal = true;
                },

                editField(field) {
                    this.showFieldDialog(field);
                },

                closeFieldModal() {
                    this.showFieldModal = false;
                    this.editingField = {};
                },

                saveField() {
                    if (!this.editingField.name || !this.editingField.type) {
                        alert('è¯·å¡«å†™å­—æ®µåç§°å’Œç±»å‹');
                        return;
                    }

                    // å¤„ç†åˆ«å
                    this.editingField.aliases = this.editingField.aliasText
                        .split(',')
                        .map(alias => alias.trim())
                        .filter(alias => alias);

                    const targetList = this.fieldType === 'contract' ? this.contractFieldList : this.procurementFieldList;

                    if (this.editingField.id) {
                        // ç¼–è¾‘æ¨¡å¼
                        const index = targetList.findIndex(f => f.id === this.editingField.id);
                        if (index > -1) {
                            targetList[index] = { ...this.editingField };
                            delete targetList[index].aliasText;
                            alert('å­—æ®µæ›´æ–°æˆåŠŸï¼');
                        }
                    } else {
                        // æ–°å»ºæ¨¡å¼
                        this.editingField.id = Date.now();
                        const newField = { ...this.editingField };
                        delete newField.aliasText;
                        targetList.unshift(newField);
                        alert('å­—æ®µåˆ›å»ºæˆåŠŸï¼');
                    }

                    this.updateFieldStats();
                    this.closeFieldModal();
                },

                importFields() {
                    const importInfo = [
                        'ğŸ“¥ å­—æ®µå¯¼å…¥åŠŸèƒ½',
                        '',
                        'æ”¯æŒå¯¼å…¥æ ¼å¼ï¼š',
                        'â€¢ Excelæ–‡ä»¶ (.xlsx, .xls)',
                        'â€¢ CSVæ–‡ä»¶ (.csv)',
                        'â€¢ JSONæ–‡ä»¶ (.json)',
                        '',
                        'å¯¼å…¥å­—æ®µæ ¼å¼è¦æ±‚ï¼š',
                        'â€¢ å­—æ®µåç§°ï¼ˆå¿…å¡«ï¼‰',
                        'â€¢ å­—æ®µç±»å‹ï¼ˆå¿…å¡«ï¼‰',
                        'â€¢ å­—æ®µåˆ«åï¼ˆå¯é€‰ï¼Œé€—å·åˆ†éš”ï¼‰',
                        '',
                        'ç¤ºä¾‹æ•°æ®ï¼š',
                        'å­—æ®µåç§° | å­—æ®µç±»å‹ | å­—æ®µåˆ«å',
                        'åˆåŒç¼–å· | æ–‡æœ¬ | ç¼–å·,åˆåŒå·',
                        'ç­¾çº¦æ—¥æœŸ | æ—¥æœŸ | ç­¾ç½²æ—¥æœŸ,åˆåŒæ—¥æœŸ'
                    ].join('\n');

                    alert(importInfo);
                },

                deleteField(field) {
                    if (confirm(`ç¡®å®šåˆ é™¤å­—æ®µ "${field.name}" å—ï¼Ÿ`)) {
                        const list = this.fieldType === 'contract' ? this.contractFieldList : this.procurementFieldList;
                        const index = list.findIndex(f => f.id === field.id);
                        if (index > -1) {
                            list.splice(index, 1);
                            this.updateFieldStats();
                            alert('å­—æ®µåˆ é™¤æˆåŠŸï¼');
                        }
                    }
                },

                exportFields() {
                    const fields = this.filteredFields;
                    if (fields.length === 0) {
                        alert('æ²¡æœ‰å¯å¯¼å‡ºçš„å­—æ®µæ•°æ®');
                        return;
                    }

                    const exportData = fields.map(field => ({
                        'å­—æ®µåç§°': field.name,
                        'å­—æ®µç±»å‹': field.type,
                        'åˆ«ååˆ—è¡¨': field.aliases.join(', ')
                    }));

                    console.log('å¯¼å‡ºå­—æ®µæ•°æ®:', exportData);
                    alert(`${this.fieldType === 'contract' ? 'åˆåŒ' : 'é‡‡è´­'}å­—æ®µå¯¼å‡ºæˆåŠŸï¼å…±å¯¼å‡º ${exportData.length} æ¡è®°å½•`);
                },

                // æ•°æ®å¯¼å…¥æ–¹æ³•
                selectFiles() {
                    const input = document.createElement('input');
                    input.type = 'file';
                    input.multiple = true;
                    input.accept = CONFIG.ALLOWED_EXTENSIONS.join(',');
                    input.onchange = (e) => this.handleFileSelect(e.target.files);
                    input.click();
                },

                selectFolder() {
                    const input = document.createElement('input');
                    input.type = 'file';
                    input.webkitdirectory = true;
                    input.onchange = (e) => this.handleFileSelect(e.target.files);
                    input.click();
                },

                handleFileSelect(files) {
                    Array.from(files).forEach(file => {
                        if (this.validateFile(file)) {
                            this.addFileToList(file);
                        }
                    });
                },

                handleDrop(e) {
                    const files = e.dataTransfer.files;
                    this.handleFileSelect(files);
                },

                validateFile(file) {
                    if (file.size > CONFIG.MAX_FILE_SIZE) {
                        alert('æ–‡ä»¶å¤§å°è¶…å‡ºé™åˆ¶ï¼ˆæœ€å¤§50MBï¼‰');
                        return false;
                    }
                    const ext = '.' + file.name.split('.').pop().toLowerCase();
                    if (!CONFIG.ALLOWED_EXTENSIONS.includes(ext)) {
                        alert('æ–‡ä»¶æ ¼å¼ä¸æ”¯æŒï¼Œä»…æ”¯æŒ .xlsx, .xls æ ¼å¼');
                        return false;
                    }
                    return true;
                },

                addFileToList(file) {
                    const newFile = {
                        id: Date.now() + Math.random(),
                        name: file.name,
                        size: this.formatFileSize(file.size),
                        sheetCount: Math.floor(Math.random() * 5) + 1
                    };
                    this.importFileList.unshift(newFile);
                    this.updateImportStats();
                },

                formatFileSize(bytes) {
                    if (bytes === 0) return '0 B';
                    const k = 1024;
                    const sizes = ['B', 'KB', 'MB', 'GB'];
                    const i = Math.floor(Math.log(bytes) / Math.log(k));
                    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
                },

                clearFiles() {
                    if (confirm('ç¡®å®šæ¸…ç©ºæ‰€æœ‰æ–‡ä»¶å—ï¼Ÿ')) {
                        this.importFileList = [];
                        this.updateImportStats();
                        alert('æ–‡ä»¶åˆ—è¡¨å·²æ¸…ç©º');
                    }
                },

                showImportSettings() {
                    this.showImportSettingsModal = true;
                },

                closeImportSettingsModal() {
                    this.showImportSettingsModal = false;
                },

                saveImportSettings() {
                    alert('å¯¼å…¥è®¾ç½®å·²ä¿å­˜ï¼\n\nå½“å‰è®¾ç½®ï¼š\n' +
                        `åŒ¹é…æ¨¡å¼: ${this.importSettings.matchMode === 'auto' ? 'è‡ªåŠ¨åŒ¹é…' : this.importSettings.matchMode === 'strict' ? 'ä¸¥æ ¼åŒ¹é…' : 'æ¨¡ç³ŠåŒ¹é…'}\n` +
                        `æœ€å°‘åŒ¹é…å­—æ®µæ•°: ${this.importSettings.minMatchFields}ä¸ª\n` +
                        `è·³è¿‡ç©ºè¡Œ: ${this.importSettings.skipEmptyRows ? 'æ˜¯' : 'å¦'}\n` +
                        `è‡ªåŠ¨å»é™¤ç©ºæ ¼: ${this.importSettings.trimWhitespace ? 'æ˜¯' : 'å¦'}\n` +
                        `å¯ç”¨æ•°æ®éªŒè¯: ${this.importSettings.validateData ? 'æ˜¯' : 'å¦'}`
                    );
                    this.closeImportSettingsModal();
                },

                updateAllFiles() {
                    if (this.importFileList.length === 0) {
                        alert('æ²¡æœ‰å¯æ›´æ–°çš„æ–‡ä»¶');
                        return;
                    }

                    const updateInfo = [
                        'ğŸ”„ æ›´æ–°æ‰€æœ‰æ–‡ä»¶æ•°æ®',
                        '',
                        `å°†æ›´æ–° ${this.importFileList.length} ä¸ªæ–‡ä»¶çš„æ•°æ®ï¼š`,
                        'â€¢ é‡æ–°è§£æå·¥ä½œè¡¨ç»“æ„',
                        'â€¢ æ›´æ–°å­—æ®µåŒ¹é…ç»“æœ',
                        'â€¢ åˆ·æ–°æ•°æ®ç»Ÿè®¡ä¿¡æ¯',
                        'â€¢ éªŒè¯æ•°æ®å®Œæ•´æ€§',
                        '',
                        'é¢„è®¡è€—æ—¶ï¼šçº¦30ç§’',
                        '',
                        'ç¡®å®šè¦ç»§ç»­å—ï¼Ÿ'
                    ].join('\n');

                    if (confirm(updateInfo)) {
                        alert('å¼€å§‹æ›´æ–°æ‰€æœ‰æ–‡ä»¶æ•°æ®...\n\nè¿™ä¸ªè¿‡ç¨‹å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚');
                        // è¿™é‡Œå¯ä»¥æ·»åŠ å®é™…çš„æ›´æ–°é€»è¾‘
                        setTimeout(() => {
                            alert('æ‰€æœ‰æ–‡ä»¶æ•°æ®æ›´æ–°å®Œæˆï¼');
                        }, 2000);
                    }
                },

                viewFileDetail(file) {
                    // æ¨¡æ‹Ÿå·¥ä½œè¡¨è¯†åˆ«æƒ…å†µ
                    const sheets = [];
                    for (let i = 1; i <= file.sheetCount; i++) {
                        const sheetTypes = ['åˆåŒæ•°æ®', 'é‡‡è´­æ•°æ®', 'é¡¹ç›®ä¿¡æ¯', 'ä¾›åº”å•†ä¿¡æ¯', 'è´¢åŠ¡æ•°æ®'];
                        const sheetType = sheetTypes[Math.floor(Math.random() * sheetTypes.length)];
                        sheets.push({
                            name: `Sheet${i}`,
                            type: sheetType,
                            rows: Math.floor(Math.random() * 500) + 50,
                            status: 'âœ… è¯†åˆ«æˆåŠŸ'
                        });
                    }

                    let detailText = `ğŸ“‹ æ–‡ä»¶è¯¦æƒ…\n`;
                    detailText += `æ–‡ä»¶å: ${file.name}\n`;
                    detailText += `æ–‡ä»¶å¤§å°: ${file.size}\n`;
                    detailText += `å·¥ä½œè¡¨æ•°é‡: ${file.sheetCount}\n`;
                    detailText += `æ•´ä½“çŠ¶æ€: ${this.getStatusText(file.status)}\n\n`;
                    detailText += `ğŸ“Š å·¥ä½œè¡¨è¯†åˆ«æƒ…å†µ:\n`;

                    sheets.forEach((sheet, index) => {
                        detailText += `${index + 1}. ${sheet.name}\n`;
                        detailText += `   ç±»å‹: ${sheet.type}\n`;
                        detailText += `   æ•°æ®è¡Œæ•°: ${sheet.rows}\n`;
                        detailText += `   çŠ¶æ€: ${sheet.status}\n\n`;
                    });

                    alert(detailText);
                },

                deleteFile(file) {
                    const index = this.importFileList.findIndex(f => f.id === file.id);
                    if (index > -1) {
                        this.importFileList.splice(index, 1);
                        this.updateImportStats();
                        alert('æ–‡ä»¶åˆ é™¤æˆåŠŸ');
                    }
                },

                // åˆåŒç®¡ç†æ–¹æ³•
                showAdvancedFilter() {
                    const filterOptions = [
                        'ğŸ” é«˜çº§ç­›é€‰é€‰é¡¹',
                        '',
                        'ğŸ“… æ—¶é—´èŒƒå›´ç­›é€‰',
                        'â€¢ ç­¾çº¦æ—¥æœŸèŒƒå›´',
                        'â€¢ åˆ›å»ºæ—¥æœŸèŒƒå›´',
                        'â€¢ æ›´æ–°æ—¥æœŸèŒƒå›´',
                        '',
                        'ğŸ’° é‡‘é¢ç­›é€‰',
                        'â€¢ åˆåŒé‡‘é¢èŒƒå›´',
                        'â€¢ é‡‘é¢åŒºé—´ï¼š<10ä¸‡, 10-50ä¸‡, 50-100ä¸‡, >100ä¸‡',
                        '',
                        'ğŸ¢ ä¸»ä½“ç­›é€‰',
                        'â€¢ ç”²æ–¹å•ä½ç­›é€‰',
                        'â€¢ ä¹™æ–¹å•ä½ç­›é€‰',
                        'â€¢ é¡¹ç›®å…³è”çŠ¶æ€',
                        '',
                        'ğŸ“‹ çŠ¶æ€ç­›é€‰',
                        'â€¢ åˆåŒæ‰§è¡ŒçŠ¶æ€',
                        'â€¢ å®¡æ‰¹çŠ¶æ€'
                    ].join('\n');

                    alert(filterOptions);
                },

                resetFilters() {
                    this.contractSearch = '';
                    // é‡ç½®å…¶ä»–ç­›é€‰æ¡ä»¶
                    const dateInputs = document.querySelectorAll('.date-input');
                    dateInputs.forEach(input => input.value = '');

                    alert('æ‰€æœ‰ç­›é€‰æ¡ä»¶å·²é‡ç½®');
                },

                showColumnConfig() {
                    const columns = [
                        'ğŸ“Š åˆ—æ˜¾ç¤ºé…ç½®',
                        '',
                        'âœ… å½“å‰æ˜¾ç¤ºåˆ—ï¼š',
                        'â€¢ åºå·',
                        'â€¢ åˆåŒç¼–å·',
                        'â€¢ å…³è”é¡¹ç›®',
                        'â€¢ ç”²æ–¹',
                        'â€¢ ä¹™æ–¹',
                        'â€¢ ç­¾çº¦æ—¥æœŸ',
                        'â€¢ åˆåŒé‡‘é¢',
                        'â€¢ æ“ä½œ',
                        '',
                        'âš™ï¸ å¯é€‰æ˜¾ç¤ºåˆ—ï¼š',
                        'â€¢ åˆåŒçŠ¶æ€',
                        'â€¢ åˆ›å»ºæ—¶é—´',
                        'â€¢ æ›´æ–°æ—¶é—´',
                        'â€¢ å¤‡æ³¨ä¿¡æ¯'
                    ].join('\n');

                    alert(columns);
                },

                exportContracts() {
                    const contracts = this.selectedContracts.length > 0
                        ? this.contractList.filter(c => this.selectedContracts.includes(c.id))
                        : this.filteredContracts;

                    if (contracts.length === 0) {
                        alert('æ²¡æœ‰å¯å¯¼å‡ºçš„åˆåŒæ•°æ®');
                        return;
                    }

                    const exportData = contracts.map(contract => ({
                        'åˆåŒç¼–å·': contract.number,
                        'å…³è”é¡¹ç›®': contract.projectName || 'æœªå…³è”',
                        'ç”²æ–¹': contract.partyA,
                        'ä¹™æ–¹': contract.partyB,
                        'ç­¾çº¦æ—¥æœŸ': contract.signDate,
                        'åˆåŒé‡‘é¢': contract.amount
                    }));

                    console.log('å¯¼å‡ºåˆåŒæ•°æ®:', exportData);
                    alert(`åˆåŒæ•°æ®å¯¼å‡ºæˆåŠŸï¼å…±å¯¼å‡º ${exportData.length} æ¡è®°å½•`);
                },

                batchOperations() {
                    if (this.selectedContracts.length === 0) {
                        alert('è¯·å…ˆé€‰æ‹©è¦æ“ä½œçš„åˆåŒ');
                        return;
                    }

                    const operations = [
                        'ğŸ“¦ æ‰¹é‡æ“ä½œé€‰é¡¹',
                        '',
                        `å·²é€‰æ‹© ${this.selectedContracts.length} ä¸ªåˆåŒ`,
                        '',
                        'å¯æ‰§è¡Œæ“ä½œï¼š',
                        'â€¢ æ‰¹é‡å¯¼å‡º',
                        'â€¢ æ‰¹é‡å…³è”é¡¹ç›®',
                        'â€¢ æ‰¹é‡ä¿®æ”¹çŠ¶æ€',
                        'â€¢ æ‰¹é‡åˆ é™¤',
                        'â€¢ æ‰¹é‡æ‰“å°'
                    ].join('\n');

                    alert(operations);
                },

                refreshContracts() {
                    console.log('æ­£åœ¨åˆ·æ–°åˆåŒæ•°æ®...');

                    setTimeout(() => {
                        // æ¨¡æ‹Ÿæ›´æ–°ç»Ÿè®¡æ•°æ®
                        this.contractStats.total = this.contractList.length;
                        this.contractStats.linked = this.contractList.filter(c => c.projectName).length;
                        this.contractStats.unlinked = this.contractStats.total - this.contractStats.linked;
                        alert('åˆåŒæ•°æ®åˆ·æ–°æˆåŠŸï¼');
                    }, 500);
                },

                switchView() {
                    const viewOptions = [
                        'ğŸ“Š è§†å›¾åˆ‡æ¢é€‰é¡¹',
                        '',
                        'å½“å‰è§†å›¾ï¼šè¡¨æ ¼è§†å›¾',
                        '',
                        'å¯åˆ‡æ¢è§†å›¾ï¼š',
                        'â€¢ å¡ç‰‡è§†å›¾',
                        'â€¢ æ—¶é—´è½´è§†å›¾',
                        'â€¢ ç»Ÿè®¡å›¾è¡¨è§†å›¾',
                        'â€¢ ç”˜ç‰¹å›¾è§†å›¾',
                        'â€¢ çœ‹æ¿è§†å›¾'
                    ].join('\n');

                    alert(viewOptions);
                },

                toggleSelectAll() {
                    if (this.selectAll) {
                        this.selectedContracts = this.filteredContracts.map(c => c.id);
                    } else {
                        this.selectedContracts = [];
                    }
                },

                toggleSelectAllProcurements() {
                    if (this.selectAllProcurements) {
                        this.selectedProcurements = this.filteredProcurements.map(p => p.id);
                    } else {
                        this.selectedProcurements = [];
                    }
                },

                viewContract(contract) {
                    alert(`åˆåŒè¯¦æƒ…:\nåˆåŒç¼–å·: ${contract.number}\nå…³è”é¡¹ç›®: ${contract.projectName || 'æœªå…³è”'}\nç”²æ–¹: ${contract.partyA}\nä¹™æ–¹: ${contract.partyB}\nç­¾çº¦æ—¥æœŸ: ${contract.signDate}\nåˆåŒé‡‘é¢: ${contract.amount}`);
                },

                // é‡‡è´­ç®¡ç†æ–¹æ³•
                refreshProcurements() {
                    console.log('æ­£åœ¨åˆ·æ–°é‡‡è´­æ•°æ®...');

                    setTimeout(() => {
                        // æ¨¡æ‹Ÿæ›´æ–°ç»Ÿè®¡æ•°æ®
                        this.procurementStats.total = this.procurementList.length;
                        this.procurementStats.linked = this.procurementList.filter(p => p.projectName).length;
                        this.procurementStats.unlinked = this.procurementStats.total - this.procurementStats.linked;
                        alert('é‡‡è´­æ•°æ®åˆ·æ–°æˆåŠŸï¼');
                    }, 500);
                },

                exportProcurements() {
                    if (this.procurementList.length === 0) {
                        alert('æ²¡æœ‰å¯å¯¼å‡ºçš„é‡‡è´­æ•°æ®');
                        return;
                    }

                    const exportData = this.filteredProcurements.map(procurement => ({
                        'é‡‡è´­ç¼–å·': procurement.number,
                        'å…³è”é¡¹ç›®': procurement.projectName || 'æœªå…³è”',
                        'ä¾›åº”å•†': procurement.supplier,
                        'é‡‡è´­å†…å®¹': procurement.content,
                        'é‡‡è´­é‡‘é¢': procurement.amount,
                        'é‡‡è´­æ—¥æœŸ': procurement.date
                    }));

                    console.log('å¯¼å‡ºé‡‡è´­æ•°æ®:', exportData);
                    alert(`é‡‡è´­æ•°æ®å¯¼å‡ºæˆåŠŸï¼å…±å¯¼å‡º ${exportData.length} æ¡è®°å½•`);
                },

                editProcurement(procurement) {
                    const editInfo = [
                        'âœï¸ é‡‡è´­ä¿¡æ¯ç¼–è¾‘',
                        '',
                        `é‡‡è´­ç¼–å·: ${procurement.number}`,
                        `å½“å‰é¡¹ç›®: ${procurement.projectName || 'æœªå…³è”'}`,
                        `ä¾›åº”å•†: ${procurement.supplier}`,
                        `é‡‡è´­å†…å®¹: ${procurement.content}`,
                        `é‡‡è´­é‡‘é¢: ${procurement.amount}`,
                        `é‡‡è´­æ—¥æœŸ: ${procurement.date}`,
                        '',
                        'å¯ç¼–è¾‘å­—æ®µï¼š',
                        'â€¢ å…³è”é¡¹ç›®',
                        'â€¢ ä¾›åº”å•†ä¿¡æ¯',
                        'â€¢ é‡‡è´­å†…å®¹',
                        'â€¢ é‡‡è´­é‡‘é¢',
                        'â€¢ é‡‡è´­æ—¥æœŸ'
                    ].join('\n');

                    alert(editInfo);
                },

                viewProcurement(procurement) {
                    alert(`é‡‡è´­è¯¦æƒ…:\né‡‡è´­ç¼–å·: ${procurement.number}\nå…³è”é¡¹ç›®: ${procurement.projectName || 'æœªå…³è”'}\nä¾›åº”å•†: ${procurement.supplier}\né‡‡è´­å†…å®¹: ${procurement.content}\né‡‡è´­é‡‘é¢: ${procurement.amount}\né‡‡è´­æ—¥æœŸ: ${procurement.date}`);
                },

                // åˆ†é¡µæ–¹æ³•
                prevPage() {
                    if (this.currentPage > 1) {
                        this.currentPage--;
                    }
                },

                nextPage() {
                    if (this.currentPage < this.totalPages) {
                        this.currentPage++;
                    }
                },

                // å·¥å…·æ–¹æ³•
                getStatusClass(status) {
                    const statusMap = {
                        'success': 'status-success',
                        'partial': 'status-warning',
                        'processing': 'status-info',
                        'å·²å®Œæˆ': 'status-success',
                        'è¿›è¡Œä¸­': 'status-processing',
                        'å¾…å®¡æ ¸': 'status-warning'
                    };
                    return statusMap[status] || 'status-info';
                },

                getStatusText(status) {
                    const statusMap = {
                        'success': 'âœ… è¯†åˆ«æˆåŠŸ'
                    };
                    return statusMap[status] || status;
                },

                updateFieldStats() {
                    this.fieldStats.contract = this.contractFieldList.length;
                    this.fieldStats.procurement = this.procurementFieldList.length;
                    this.fieldStats.total = this.fieldStats.contract + this.fieldStats.procurement;
                },

                updateImportStats() {
                    this.importStats.total = this.importFileList.length;
                    this.importStats.totalSheets = this.importFileList.reduce((sum, file) => sum + file.sheetCount, 0);
                }
            },

            mounted() {
                // åˆå§‹åŒ–ç»Ÿè®¡æ•°æ®
                this.updateFieldStats();
                this.updateImportStats();

                console.log('ğŸ‰ ç®¡ç†ç³»ç»Ÿå·²å¯åŠ¨');
                console.log('ğŸ“Š ç³»ç»ŸåŠŸèƒ½å®Œå–„è¯´æ˜ï¼š');
                console.log('â€¢ æ‰€æœ‰æŒ‰é’®åŠŸèƒ½å·²å®Œå–„å®ç°');
                console.log('â€¢ æ•°æ®å¯¼å…¥æ”¯æŒå·¥ä½œè¡¨è¯¦æƒ…æŸ¥çœ‹');
                console.log('â€¢ ç§»é™¤äº†çŠ¶æ€ç›¸å…³åŠŸèƒ½');
                console.log('â€¢ ä¼˜åŒ–äº†UIè®¾è®¡å’Œç”¨æˆ·ä½“éªŒ');

                // æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯
                const welcomeMsg = [
                    'ğŸ‰ æ¬¢è¿ä½¿ç”¨ç®¡ç†ç³»ç»Ÿï¼',
                    '',
                    'âœ¨ ç³»ç»ŸåŠŸèƒ½ï¼š',
                    'â€¢ é¡¹ç›®ç®¡ç† - æ”¯æŒæ–°å»ºã€ç¼–è¾‘ã€æŸ¥çœ‹',
                    'â€¢ å­—æ®µç®¡ç† - æ”¯æŒå­—æ®µé…ç½®å’Œåˆ«åè®¾ç½®',
                    'â€¢ æ•°æ®å¯¼å…¥ - æ”¯æŒExcelæ–‡ä»¶å¯¼å…¥å’Œå·¥ä½œè¡¨è¯†åˆ«',
                    'â€¢ åˆåŒæ•°æ® - æ”¯æŒé«˜çº§ç­›é€‰å’Œæ‰¹é‡æ“ä½œ',
                    'â€¢ é‡‡è´­æ•°æ® - æ”¯æŒæ•°æ®æŸ¥çœ‹å’Œç¼–è¾‘',
                    '',
                    'ğŸš€ æ‰€æœ‰æŒ‰é’®åŠŸèƒ½å·²å®Œå–„ï¼Œå¯ä»¥å¼€å§‹ä½¿ç”¨ï¼'
                ].join('\n');

                alert(welcomeMsg);
            }
        }).mount('#app');
    </script>
</body>
</html>
